var CanvasFingerprint=Class.create({initialize:function(){this.initCanvas()},initCanvas:function(){this.canvas=new Element("canvas"),this.ctx=this.canvas.getContext("2d"),this.txt="canvasFingerprint.js",this.ctx.textBaseline="top",this.ctx.font="14px 'Arial'",this.ctx.textBaseline="alphabetic",this.ctx.fillStyle="#f60",this.ctx.fillRect(125,1,62,20),this.ctx.fillStyle="#069",this.ctx.fillText(this.txt,2,15),this.ctx.fillStyle="rgba(102, 204, 0, 0.7)",this.ctx.fillText(this.txt,4,17)},bin2hex:function(a){var b,c,d,e="";for(a+="",b=0,c=a.length;c>b;b++)d=a.charCodeAt(b).toString(16),e+=d.length<2?"0"+d:d;return e},atob:function(a){if(Object.isFunction(window.atob))return atob(a);var b,c,d="=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=function(a,b){var c=a.charCodeAt(b);return c},g=[];a=""+a;var h=a.length-a.length%3;if(0===a.length)return a;for(b=0;h>b;b+=3)c=f(a,b)<<16|f(a,b+1)<<8|f(a,b+2),g.push(e.charAt(c>>18)),g.push(e.charAt(c>>12&63)),g.push(e.charAt(c>>6&63)),g.push(e.charAt(63&c));switch(a.length-h){case 1:c=f(a,b)<<16,g.push(e.charAt(c>>18)+e.charAt(c>>12&63)+d+d);break;case 2:c=f(a,b)<<16|f(a,b+1)<<8,g.push(e.charAt(c>>18)+e.charAt(c>>12&63)+e.charAt(c>>6&63)+d)}return g.join("")},getFingerprint:function(){return this.b64=this.canvas.toDataURL().replace("data:image/png;base64,",""),this.bin=this.atob(this.b64),this.bin2hex(this.bin.slice(-16,-12))}});